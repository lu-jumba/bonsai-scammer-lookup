'use strict';

var base = require('@scure/base');

const BASE32_ALPHABET = 'abcdefghijklmnopqrstuvwxyz234567';
const coder = base.utils.chain(
// We define our own chain, the default base32 has padding
base.utils.radix2(5), base.utils.alphabet(BASE32_ALPHABET), {
    decode: (input) => input.split(''),
    encode: (input) => input.join(''),
});
function decodeBase32(input) {
    return coder.decode(input);
}
function encodeBase32(input) {
    return coder.encode(input);
}
function isBase32(input) {
    // Check that all characters are valid base32 characters
    for (let i = 0; i < input.length; i++) {
        const char = input[i];
        if (BASE32_ALPHABET.indexOf(char.toLowerCase()) === -1) {
            return false;
        }
    }
    // Check that the input length is a multiple of 8 bits
    if (input.length % 8 !== 0) {
        return false;
    }
    return true;
}

exports.decodeBase32 = decodeBase32;
exports.encodeBase32 = encodeBase32;
exports.isBase32 = isBase32;
