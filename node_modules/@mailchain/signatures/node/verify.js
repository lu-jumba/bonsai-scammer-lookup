'use strict';

var encoding = require('@mailchain/encoding');
var consts = require('./consts.js');
var eth_personal = require('./eth_personal.js');
var raw_ed25519 = require('./raw_ed25519.js');
var tezos_micheline = require('./tezos_micheline.js');

function verify(signingMethod, verifyingKey, message, signature) {
    switch (signingMethod) {
        case consts.KindEthereumPersonalMessage:
            return eth_personal.verifyEthereumPersonalMessage(verifyingKey, encoding.decodeUtf8(message), signature);
        case consts.KindRawED25519:
            return raw_ed25519.verifyRawEd25519(verifyingKey, encoding.decodeUtf8(message), signature);
        case consts.KindTezos:
            return tezos_micheline.verifyTezosSignedMessage(verifyingKey, message, signature);
        default:
            throw new Error();
    }
}

exports.verify = verify;
