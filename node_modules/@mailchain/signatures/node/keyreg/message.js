'use strict';

var crypto = require('@mailchain/crypto');
var encoding = require('@mailchain/encoding');
var templates = require('./templates.js');

function createProofMessage(params, address, msgKey, nonce) {
    const encodedAddress = encoding.encode(params.AddressEncoding, address);
    const descriptivePublicKey = crypto.publicKeyToBytes(msgKey);
    const encodedPublicKey = encoding.encode(params.PublicKeyEncoding, descriptivePublicKey);
    const templateMessageFunc = templates.getTemplate(params);
    return templateMessageFunc(encodedAddress, encodedPublicKey, nonce);
}

exports.createProofMessage = createProofMessage;
