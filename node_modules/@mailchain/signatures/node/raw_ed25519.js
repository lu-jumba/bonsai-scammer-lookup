'use strict';

var crypto = require('@mailchain/crypto');

async function signRawEd25519(signer, msg) {
    switch (signer.curve) {
        case crypto.KindED25519: {
            return signer.sign(msg);
        }
        default:
            throw new crypto.ErrorUnsupportedKey(signer.curve);
    }
}
async function verifyRawEd25519(key, msg, signature) {
    switch (key.curve) {
        case crypto.KindED25519:
            return key.verify(msg, signature);
        default:
            throw new crypto.ErrorUnsupportedKey(key.curve);
    }
}

exports.signRawEd25519 = signRawEd25519;
exports.verifyRawEd25519 = verifyRawEd25519;
