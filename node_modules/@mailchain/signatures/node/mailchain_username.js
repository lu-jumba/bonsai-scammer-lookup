'use strict';

var raw_ed25519 = require('./raw_ed25519.js');

const mailchainUsernameMessage = function (message) {
    const prefix = Buffer.from(`\x11Mailchain username ownership:\n${message.length}\n`, 'utf-8');
    return Buffer.concat([prefix, message]);
};
/**
 * Signs a message using the Mailchain username with the identity private key.
 * @param key
 * @param username
 */
async function signMailchainUsername(signer, username) {
    return raw_ed25519.signRawEd25519(signer, mailchainUsernameMessage(username));
}
/**
 * Verifies a message linking a username with an identity key is valid.
 * @param key
 * @param username
 * @param signature
 * @returns
 */
async function verifyMailchainUsername(key, signature, username) {
    return raw_ed25519.verifyRawEd25519(key, mailchainUsernameMessage(username), signature);
}

exports.signMailchainUsername = signMailchainUsername;
exports.verifyMailchainUsername = verifyMailchainUsername;
