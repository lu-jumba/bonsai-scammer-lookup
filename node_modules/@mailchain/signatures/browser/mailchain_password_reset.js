import { signRawEd25519, verifyRawEd25519 } from './raw_ed25519.js';

const mailchainPasswordResetMessage = function (username, expires) {
    return Buffer.from(`\x11Mailchain:\naction: reset-password\nexpires: ${Math.floor(expires.getTime() / 1000)}\nusername: ${username}`, 'utf-8');
};
/**
 * Signs a message using the Mailchain username, reset attestation message, and expiration with the identity private key.
 */
async function signMailchainPasswordReset(signer, username, expires) {
    return signRawEd25519(signer, mailchainPasswordResetMessage(username, expires));
}
/**
 * Verifies message linking a username, reset attestation message, and expiration with an identity key is valid.
 */
async function verifyMailchainPasswordReset(key, signature, username, expires) {
    return verifyRawEd25519(key, mailchainPasswordResetMessage(username, expires), signature);
}

export { mailchainPasswordResetMessage, signMailchainPasswordReset, verifyMailchainPasswordReset };
