import { publicKeyToBytes } from '@mailchain/crypto';
import { encode } from '@mailchain/encoding';
import { getTemplate } from './templates.js';

function createProofMessage(params, address, msgKey, nonce) {
    const encodedAddress = encode(params.AddressEncoding, address);
    const descriptivePublicKey = publicKeyToBytes(msgKey);
    const encodedPublicKey = encode(params.PublicKeyEncoding, descriptivePublicKey);
    const templateMessageFunc = getTemplate(params);
    return templateMessageFunc(encodedAddress, encodedPublicKey, nonce);
}

export { createProofMessage };
