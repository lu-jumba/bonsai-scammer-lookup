'use strict';

var ids = require('./ids.js');

function publicKeyToBytes(key) {
    const out = new Uint8Array(key.bytes.length + 1);
    out[0] = ids.idFromPublicKey(key);
    out.set(key.bytes, 1);
    return out;
}
function publicKeyFromBytes(bytes) {
    if (bytes.length < 32 + 1) {
        throw Error('public key is too short to contain ID byte');
    }
    return ids.publicKeyFromId(bytes[0], bytes.slice(1));
}
function privateKeyToBytes(key) {
    const out = new Uint8Array(key.bytes.length + 1);
    out[0] = ids.idFromPrivateKey(key);
    out.set(key.bytes, 1);
    return out;
}
function privateKeyFromBytes(bytes) {
    if (bytes.length < 32 + 1) {
        throw Error('private key is too short to contain ID byte');
    }
    return ids.privateKeyFromId(bytes[0], bytes.slice(1));
}

exports.privateKeyFromBytes = privateKeyFromBytes;
exports.privateKeyToBytes = privateKeyToBytes;
exports.publicKeyFromBytes = publicKeyFromBytes;
exports.publicKeyToBytes = publicKeyToBytes;
