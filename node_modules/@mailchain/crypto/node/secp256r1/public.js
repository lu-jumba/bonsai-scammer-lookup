'use strict';

var p256 = require('@noble/curves/p256');
var keys = require('../keys.js');

const SECP256R1PublicKeyLength = 33;
class SECP256R1PublicKey {
    constructor(bytes) {
        Object.defineProperty(this, "bytes", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: bytes
        });
        Object.defineProperty(this, "curve", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: keys.KindSECP256R1
        });
        if (this.bytes.length !== SECP256R1PublicKeyLength) {
            throw RangeError('bytes are not a valid secp256r1 public key');
        }
    }
    async verify(message, sig) {
        return p256.secp256r1.verify(sig, message, this.bytes);
    }
}

exports.SECP256R1PublicKey = SECP256R1PublicKey;
exports.SECP256R1PublicKeyLength = SECP256R1PublicKeyLength;
