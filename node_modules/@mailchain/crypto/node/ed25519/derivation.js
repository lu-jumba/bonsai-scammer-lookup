'use strict';

var blake2b = require('@noble/hashes/blake2b');
var hd = require('../hd.js');
var _private = require('./private.js');
var hd$1 = require('./hd.js');

// 'Ed25519HDKD' encoded with length prefix
const HDKD = new Uint8Array([44, 69, 100, 50, 53, 53, 49, 57, 72, 68, 75, 68]);
function ed25519DeriveHardenedKey(parentKey, index) {
    const chainCode = hd.chainCodeFromDeriveIndex(index);
    const seed = _private.asED25519PrivateKey(parentKey.privateKey).bytes.slice(0, 32);
    return hd$1.ED25519ExtendedPrivateKey.fromPrivateKey(_private.ED25519PrivateKey.fromSeed(blake2b.blake2b(Uint8Array.from([...HDKD, ...seed, ...chainCode]), {
        dkLen: 256 / 8,
    })));
}

exports.ed25519DeriveHardenedKey = ed25519DeriveHardenedKey;
