import { secp256r1 } from '@noble/curves/p256';
import { KindSECP256R1 } from '../keys.js';

const SECP256R1PublicKeyLength = 33;
class SECP256R1PublicKey {
    constructor(bytes) {
        Object.defineProperty(this, "bytes", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: bytes
        });
        Object.defineProperty(this, "curve", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: KindSECP256R1
        });
        if (this.bytes.length !== SECP256R1PublicKeyLength) {
            throw RangeError('bytes are not a valid secp256r1 public key');
        }
    }
    async verify(message, sig) {
        return secp256r1.verify(sig, message, this.bytes);
    }
}

export { SECP256R1PublicKey, SECP256R1PublicKeyLength };
