'use strict';

/** No-operation migration. Useful when no migration is required and to provide this as default. */
/** Combine multiple migration rules into a single, where only required migrations will be applied. */
function combineMigrations(...migrations) {
    return {
        shouldApply: async (data) => {
            for (const migration of migrations) {
                if (await migration.shouldApply(data))
                    return true;
            }
            return false;
        },
        apply: async (data) => {
            let latestData = data;
            for (const migration of migrations) {
                if (await migration.shouldApply(latestData)) {
                    latestData = await migration.apply(latestData);
                }
            }
            return latestData;
        },
    };
}

exports.combineMigrations = combineMigrations;
