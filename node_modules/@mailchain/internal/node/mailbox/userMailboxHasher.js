'use strict';

var crypto = require('@mailchain/crypto');
var sha3 = require('@noble/hashes/sha3');

function createMailchainUserMailboxHasher(keyRing) {
    return async (userMailbox) => sha3.sha3_256(await keyRing.accountIdentityKey().sign(crypto.publicKeyToBytes(userMailbox.identityKey)));
}

exports.createMailchainUserMailboxHasher = createMailchainUserMailboxHasher;
