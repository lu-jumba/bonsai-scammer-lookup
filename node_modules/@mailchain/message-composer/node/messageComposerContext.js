'use strict';

var encoding = require('@mailchain/encoding');

function defaultMessageComposerContext() {
    return {
        random: (len) => typeof crypto !== 'undefined'
            ? Promise.resolve(crypto.getRandomValues(new Uint8Array(len)))
            : import('crypto').then(({ webcrypto }) => webcrypto.getRandomValues(new Uint8Array(len))),
        decodeUtf8: (content) => Promise.resolve(encoding.decodeUtf8(content)),
        encodeBase64: (content, urlSafe) => urlSafe ? Promise.resolve(encoding.encodeBase64UrlSafe(content)) : Promise.resolve(encoding.encodeBase64(content)),
    };
}

exports.defaultMessageComposerContext = defaultMessageComposerContext;
