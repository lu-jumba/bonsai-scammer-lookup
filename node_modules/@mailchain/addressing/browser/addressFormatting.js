import { humanNameServiceFormatters } from './addressFormattingRule.js';
import { formatMailLike } from './formatMailLike.js';
import { isNameServiceAddress } from './nameServiceAddress.js';

function formatAddress(address, format) {
    if (isNameServiceAddress(address))
        return formatNameServiceAddress(address, format);
    throw new Error(`unknown format of the provided address [${JSON.stringify(address)}]`);
}
function formatNameServiceAddress(address, format) {
    switch (format) {
        case 'mail':
            return formatMailLike(address.username, address.domain);
        case 'human-friendly':
            for (const formatter of humanNameServiceFormatters) {
                const formatted = formatter(address);
                if (formatted)
                    return formatted;
            }
            throw new Error(`failed to format address [${JSON.stringify(address)}]`);
    }
}

export { formatAddress };
