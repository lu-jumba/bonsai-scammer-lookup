'use strict';

var encoding = require('@mailchain/encoding');
var consts = require('./consts.js');

/**
 * Tries to guess what protocols this address could be. It will check for length, characters, and prefixes (where relevant).
 * @param address
 * @returns List of possible protocols. There are no guarantees the address exists on any of the returned protocols.
 */
function guessProtocolsFromAddress(address) {
    address = address.trim();
    const isAddressHex = encoding.isAnyHex(address);
    const protocols = new Set();
    // needs to be a series of if statements as can be multiple protocols
    if (isAddressHex && address.length === 42 && address.startsWith('0x')) {
        protocols.add(consts.ETHEREUM);
    }
    if (address.length <= 20 && address.length >= 2 && new RegExp('^[a-zA-Z0-9_-]+$').test(address)) {
        protocols.add(consts.MAILCHAIN);
    }
    return Array.from(protocols);
}

exports.guessProtocolsFromAddress = guessProtocolsFromAddress;
